    next_scenario=null

    map_data="{~add-ons/Grnk/part1/maps/02_Shmaltupp.map}"

    {DEFAULT_SCHEDULE}
    turns=-1
    victory_when_enemies_defeated=no

    # Grnk's side
    [side]
        side=1
        controller=human
        id=Grnk

        team_name=Grnk
        user_team_name=_"Grnk"

        village_gold=0
        gold=0
        income=-2  # No income whatsoever
    [/side]

    # Human army side
    [side]
        side=2
        controller=ai
        id=Koorzhar
        name=_"Koorzhar"
        type=Shmaltupp Lieutenant

        gender=male
        unrenamable=yes

        team_name=Grnk,villagers4,villagers5,rats
        user_team_name=_"Human Army"
        save_id=Koorzhar
        persistent=yes

        recruit=Heavy Infantryman,Bowman,Spearman

        gold=0
        income=-2
    [/side]

    # Bandit side
    [side]
        side=3
        controller=ai
        id=Rutburt
        name=_"Rutburt"
        type=Outlaw

        gender=male
        unrenamable=yes

        team_name=Grnk,villagers4,villagers5,rats
        user_team_name=_"Bandits"
        save_id=Rutburt
        persistent=yes

        recruit=Ruffian,Footpad,Thug,Poacher

        gold=0
        income=-2
    [/side]

    # Villager side 4
    [side]
        side=4
        controller=ai
        no_leader=yes

        team_name=villagers4,rats
        user_team_name=_"Villagers"

        gold=0
        income=-2
    [/side]

    # Villager side 5
    [side]
        side=5
        controller=ai
        no_leader=yes

        team_name=villagers5,rats
        user_team_name=_"Villagers"

        gold=0
        income=-2
    [/side]

    # Rats
    [side]
        side=6
        controller=ai
        no_leader=yes

        team_name=rats
        user_team_name=_"Rats"

        gold=0
        income=-2

        [ai]
            aggression=0.0
            caution=1.0
        [/ai]
    [/side]

    #############################################################################
    # I decided to put all the generic villages, villager and rats events into
    # macros in a separate file (Grnk-Shmaltupp.cfg), so that I could concentrate
    # here on the story elements
    # Events involving Grnk and the villagers/rats are kept in this scenario file
    {SETUP_SHMALTUPP_MAP}
    {KEEP_KOORZHAR_IN_PLACE}
    {KEEP_RUTBURT_IN_PLACE}

    # Villagers - Sides 4 & 5
    {PLACE_VILLAGERS_EACH_TURN 4 "2..5"}
    {PLACE_VILLAGERS_EACH_TURN 5 "2..5"}
    {NO_ATTACKS_LEFT 4 99}
    {NO_ATTACKS_LEFT 5 99}
    {HIDE_VILLAGER_AT_GOAL}
    {KILL_UNITS_END_SIDE_TURN 4}
    {KILL_UNITS_END_SIDE_TURN 5}

    # Rats - Side 6
    {NO_ATTACKS_LEFT 6 100}
    {NEW_RAT 100}
    {RATS_RANDOM_WANDER}
    {REMOVE_RAT 25}
    #############################################################################

    [event]
        name=prestart

        # Note: Shmaltupp contains variables that need to be kept
        #   for several visits to Shmaltupp
        # S2 contains variables that can be deleted at the end of the current visit

        # Set up the counters, variables
        {IF_VAR Shmaltupp.times_to_Shmaltupp equals "" (
            [then]
                {VARIABLE Shmaltupp.times_to_Shmaltupp 1}
                {VARIABLE Shmaltupp.rats_killed 0}
                {VARIABLE Shmaltupp.bar_visited 0}
                {VARIABLE Shmaltupp.beers_drunk 0}
            [/then]

            [else]
                # Next times: up the counter, set side gold from Grnk's gold
                {VARIABLE_OP Shmaltupp.times_to_Shmaltupp add 1}
            [/else]
        )}

        # Also set the money variables
        # In principle, they only need to be set once, but it's easier for debugging and changing this way
        # Not all of these are needed in this scenario, collected here for convenience
        # The only ones not included is the starting gold of S1
        # and the cost of beer at the pub (because I am too lazy and it doesn't really matter)
        # In Shmaltupp:
        {VARIABLE Money.cage_cost 89}
        {VARIABLE Money.cart_cost 72}
        {VARIABLE Money.poison_cost 19}
        {VARIABLE Money.healing_potion_cost 10}
        {VARIABLE Money.rat_pay 5}
        {VARIABLE Money.STC_gold_per_hitpoint 0.5}
        {VARIABLE Money.STC_curing_cost 3}
        {VARIABLE Money.Quank_gold_per_hitpoint 0.25}
        # Pickpocketing (all of this is x10 of actual gold)
        {VARIABLE Money.pickpocket_base "10..30"}
        {VARIABLE Money.pickpocket_per_level 10}
        {VARIABLE Money.pickpocket_multiplier 1.4}
        # Later scenarios
        {VARIABLE Money.S3_gold_for_Grnk "101..111"}
        {VARIABLE Money.S4_victory_gold 25}
        {VARIABLE Money.S4_kill_orc_leader_bonus 15}
        {VARIABLE Money.S4_poison_bonus 10}
        {VARIABLE Money.S4_early_bonus 1}
        {VARIABLE Money.S5_bonus_per_level 8}

        # Set up menu items, gold and inventory, pickpocket menu
        {SET_MENU_INVENTORY}
        {SET_MENU_PICKPOCKET}

        # Set up Grnk's side: gold and units
        {IF_VAR Shmaltupp.times_to_Shmaltupp equals 1 (
            [then]  # First time: get Grnk's gold from side gold
                [store_gold]
                    side=1
                    variable=Grnks_gold
                [/store_gold]

                # Also, kill everybody on Grnk's side who might still be alive
                [kill]
                    side=1
                    [not]
                        id=Grnk
                    [/not]
                [/kill]
            [/then]

            [else]  # Next times: set side gold from Grnk's gold
                {SET_GOLD 1 $Grnks_gold}
            [/else]
        )}

        # Also, move Grnk to the correct starting positions,
        # And have him face the right way
        # Store away units, etc., as needed, depending on which scenario we come from
        [switch]
            variable=Shmaltupp.times_to_Shmaltupp

            [case]
                value=1,3

                {MODIFY_UNIT id=Grnk facing ne}
            [/case]

            [case]
                value=2

                {CLOSE_EMPTY_HEX 30 3 (W*,S*) 0}
                {MOVE_UNIT id=Grnk $hex_x $hex_y}
                {CLEAR_VARIABLE hex_x,hex_y}
                {MODIFY_UNIT id=Grnk facing nw}
            [/case]

            [case]
                value=3

                # Store away Gertburt, Wyssauba from previous scenario
                # This way they are fully healed, got final kill XP, etc.
                # Set mode=append, so that variables do not get
                # erased in case we never went through S5
                [store_unit]
                    [filter]
                        id=Wyssauba
                    [/filter]

                    kill=yes
                    variable=stored_Wyssauba
                    mode=append
                [/store_unit]

                [store_unit]
                    [filter]
                        id=Gertburt
                    [/filter]

                    kill=yes
                    variable=stored_Gertburt
                    mode=append
                [/store_unit]

                # Rutburt is not around in this scenario
                {PUT_TO_RECALL_LIST id=Rutburt}
            [/case]

            [case]
                value=4

                {CLOSE_EMPTY_HEX 29 21 (W*,S*) 0}
                {MOVE_UNIT id=Grnk $hex_x $hex_y}
                {CLEAR_VARIABLE hex_x,hex_y}
                {MODIFY_UNIT id=Grnk facing nw}

                # Rutburt is not around in this scenario
                {PUT_TO_RECALL_LIST id=Rutburt}
            [/case]

            [case]
                value=5

                {CLOSE_EMPTY_HEX 19 2 (W*,S*) 0}
                {MOVE_UNIT id=Grnk $hex_x $hex_y}
                {CLEAR_VARIABLE hex_x,hex_y}
                {MODIFY_UNIT id=Grnk facing ne}
            [/case]
        [/switch]

        # Kill Koorzhar's recall list, to delete units from last time
        # For simplicity, the guards get put out anew each time
        [kill]
            side=2
            role=city guard
            [not]
                x=1-999
            [/not]
        [/kill]

        # And set up the info menu
        [set_menu_item]
            id=m002_menu_scenario2
            description=_"Scenario Information"
            image=items/ring-red.png~CROP(26,26,20,20)
            [command]
                {NARRATOR_GRAY _"Shmaltupp Scenario Information" _"It appears that there is something rather unhealthy in the air of Shmaltupp, as healing by resting does not work here. Furthermore, buildings on the map are just that, buildings, not villages that provide healing benefits. If you need to heal Grnk, move him to one of the medical establishments, some more reputable than others, where he can be cared for for a small charge. Note that leaders of groups which Grnk might want to join will generally not take him along if he is not in perfect health.
<i> </i>
As distances within Shmaltupp are shorter than those on a typical 'landscape map,' Grnk's movement points are doubled here.
<i> </i>
Also check out the 'pickpocket' and 'inventory' right-click menu items for additional information."}
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=start

        [switch]
            variable=Shmaltupp.times_to_Shmaltupp

            [case]
                value=1

                {MESSAGE_RIGHT Grnk _"So this is Shmaltupp. It's even bigger than I imagined. And so many people, all living together peacefully!"}

                # Give GRNK the pickpocket special
                {PICKPOCKET id=Grnk}
            [/case]

            [case]
                value=2

                {MESSAGE Grnk "" "" _"It's not quite as strange any more as the first time."}
            [/case]

            [case]
                value=3

                {MESSAGE Grnk "" "" _"This place is starting to grow on me. Slowly."}
            [/case]

            [case]
                value=4

                {SCROLL_TO 28 19}
                {STORE_UNIT_VAR (x,y=28,19) id S2.post_id}
                {MESSAGE $S2.post_id "" "" _"Halt! You cannot bring that beast into town."}
                {MESSAGE Grnk "" "" _"Says who?"}
                {MESSAGE $S2.post_id "" "" _"Says Lieutenant Koorzhar. You can either leave your wolf outside the city gates or stay out yourself."}
                {MESSAGE Grnk "" "" _"But what if my wolf runs away? I only just caught him."}
                {MESSAGE $S2.post_id "" "" _"That's not my problem. Now are you going to get that mutt off my bridge or shall I call the Lieutenant? He's not going to be happy about that."}
                {MESSAGE Grnk "" "" _"Alright, alright, I was just asking."}

                {CLOSE_EMPTY_HEX 31 24 (W*,S*) 0}
                {MOVE_UNIT id=Grnk $hex_x $hex_y}
                {MESSAGE Grnk "" "" _"You wait here while I am gone. And stay away from those rats, you hear me?"}
                {SOUND wolf-die.wav}
                {MESSAGE narrator "units/monsters/wolf.png" "" _"Yelp !"}

                # Store Grnk the Wolf Rider
                [store_unit]
                    [filter]
                        id=Grnk
                    [/filter]

                    variable=S2.stored_Grnk_rider
                    kill=yes
                [/store_unit]

                # Get the wolf out
                {VARIABLE stored_Grnks_wolf.side 1}
                {VARIABLE stored_Grnks_wolf.goto_x ""}
                {VARIABLE stored_Grnks_wolf.goto_y ""}
                [unstore_unit]
                    variable=stored_Grnks_wolf
                    x,y=$hex_x,$hex_y
                [/unstore_unit]
                {FULL_HEAL_AND_CURE id=Grnks_wolf}
                {CLEAR_VARIABLE stored_Grnks_wolf}

                # Move Grnk back
                {VARIABLE S2.oldhex_x $hex_x}
                {VARIABLE S2.oldhex_y $hex_y}
                {CLOSE_EMPTY_HEX 28 20 (W*,S*) 0}
                [move_unit_fake]
                    type=$stored_Grnk.type
                    side=1
                    x=$S2.oldhex_x,$hex_x
                    y=$S2.oldhex_y,$hex_y
                [/move_unit_fake]

                # Unstore Grnk
                {VARIABLE stored_Grnk.side 1}
                {VARIABLE stored_Grnk.facing nw}
                {VARIABLE stored_Grnk.canrecruit yes}
                {VARIABLE stored_Grnk.overlays ""}
                [unstore_unit]
                    variable=stored_Grnk
                    x,y=$hex_x,$hex_y
                [/unstore_unit]
                {FULL_HEAL_AND_CURE id=Grnk}
                {CLEAR_VARIABLE stored_Grnk}

                {MESSAGE Grnk "" "" _"Better?"}
                {MESSAGE $S2.post_id "" "" _"Better. Have a pleasant stay in Shmaltupp."}
                {MOVE_UNIT id=Grnk 25 19}

                {CLEAR_VARIABLE S2.oldhex_x,S2.oldhex_y,hex_x,hex_y,S2.post_id}
            [/case]

            [case]
                value=5

                {SCROLL_TO 18 2}
                {MESSAGE Grnk "" "" _"Alright, little puppy, you know the drill."}
                {SOUND  wolf-growl-1.ogg}
                {MESSAGE narrator "units/monsters/wolf.png" "" _"Grrrrrrwwwllll !!!"}

                # Store Grnk the Wolf Rider
                [store_unit]
                    [filter]
                        id=Grnk
                    [/filter]

                    variable=S2.stored_Grnk_rider
                    kill=yes
                [/store_unit]

                # Get the wolf out
                {VARIABLE stored_Grnks_wolf.moves 0}
                [unstore_unit]
                    variable=stored_Grnks_wolf
                    x,y=19,2
                [/unstore_unit]
                {FULL_HEAL_AND_CURE id=Grnks_wolf}
                {CLEAR_VARIABLE stored_Grnks_wolf}

                # Move Grnk to starting position
                {CLOSE_EMPTY_HEX 18 5 (W*,S*) 0}
                [move_unit_fake]
                    type=$stored_Grnk.type
                    side=1
                    x=$S2.stored_Grnk_rider.x,$hex_x
                    y=$S2.stored_Grnk_rider.y,$hex_y
                [/move_unit_fake]

                # Unstore Grnk
                {VARIABLE stored_Grnk.facing ne}
                [unstore_unit]
                    variable=stored_Grnk
                    x,y=$hex_x,$hex_y
                [/unstore_unit]
                {FULL_HEAL_AND_CURE id=Grnk}
                {MODIFY_UNIT id=Grnk canrecruit yes}
                {MODIFY_UNIT id=Grnk overlays ""}
                {CLEAR_VARIABLE stored_Grnk}

                {CLEAR_VARIABLE hex_x,hex_y}
            [/case]

            [else]
                {MESSAGE Grnk "" "" _"Here we go again."}
            [/else]
        [/switch]

        # Double Grnk's movement points (reverted at end of scenario)
        {STORE_UNIT_VAR id=Grnk max_moves S2.Grnk_max_moves}
        {MODIFY_UNIT id=Grnk max_moves "$($S2.Grnk_max_moves*2)"}
        {MODIFY_UNIT id=Grnk moves "$($S2.Grnk_max_moves*2)"}

        # This needs to be reset if Grnk advances, but we only reset max_moves
        # then, not moves. Also, the behavior is different depending on whether
        # this is a unit type or an AMLA advancement. The solution here is
        # somewhat awkward, but I don't know how to do it more elegantly.
        [event]
            name=post advance
            first_time_only=no

            [switch]
                variable=unit.max_moves

                [case]
                    value=6  # After advancement from spearman to rouser

                    {VARIABLE S2.Grnk_max_moves 6}
                    {MODIFY_UNIT id=Grnk max_moves 12}
                [/case]

                [case]
                    value=13  # If MP are increased through AMLA

                    {VARIABLE S2.Grnk_max_moves 7}
                    {MODIFY_UNIT id=Grnk max_moves 14}
                [/case]

                [else]
                    # Placeholder; I believe all other cases don't need special treatment
                [/else]
            [/switch]
        [/event]

        [objectives]
            victory_string=_"<span color='#A050A0'>Explore Shmaltupp</span>"
            [objective]
                description=_"Figure out what to do next"
                condition=win
            [/objective]
            [objective]
                [show_if]
                    {VARIABLE_CONDITIONAL Shmaltupp.caught_fighting equals yes}
                [/show_if]
                description=_"Attack another villager"
                condition=lose
            [/objective]
            [objective]
                [show_if]
                    {VARIABLE_CONDITIONAL Shmaltupp.camp_entered equals yes}
                [/show_if]
                description=_"Enter the army camp again"
                condition=lose
            [/objective]
            [objective]
                description=_"Death of Grnk"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=no
                carryover_percentage=100
            [/gold_carryover]
            [note]
                description=_"Villagers and rats act as Grnk's allies during their turn and never attack him. They do, however, defend themselves if attacked during his turn."
            [/note]
            [note]
                description=_"Right-click on the map for additional information about this scenario."
            [/note]
        [/objectives]
    [/event]

    # No rest healing for Grnk (or anybody on his side)
    [event]
        name=side 1 turn
        first_time_only=no

        {MODIFY_UNIT (side=1) resting no}
    [/event]

    # If Grnk brings his Wolf to town, it never moves
    [event]
        name=side 1 turn refresh
        first_time_only=no

        {MODIFY_UNIT id=Grnks_wolf moves 0}
    [/event]

    # Comment the first time the villagers attack each other
    [event]
        name=attack end

        [filter]
            side=4,5
        [/filter]
        [filter_second]
            side=4,5
        [/filter_second]
        [filter_condition]
            {VARIABLE_CONDITIONAL Shmaltupp.witnessed_fight not_equals yes}
        [/filter_condition]

        {DELAY 500}
        {MESSAGE Grnk "" "" _"I guess they only live together <i>mostly</i> peacefully."}
        # Need to set variable (in spite of first_time_only=yes), as this is supposed to work
        # every time we come back to this scenario
        {VARIABLE Shmaltupp.witnessed_fight yes}
    [/event]

    ##### Villager events #####

    # If Grnk attacks a villager, ...
    [event]
        name=attack end
        first_time_only=no

        [filter]
            id=Grnk
        [/filter]
        [filter_attack]
            [not]
                name=pickpocket
            [/not]
        [/filter_attack]
        [filter_second]
            side=4,5
        [/filter_second]
        [filter_condition]
            {VARIABLE_CONDITIONAL unit.hitpoints greater_than 0}
        [/filter_condition]

        # Bring out the sergeant - trigger by attack here directly and by
        # use of poison, which needs a separate trigger as that attack gets interrupted

        # If this is the first time
        {IF_VAR Shmaltupp.caught_fighting not_equals yes (
            [then]
                {SOUND fanfare-short.wav}
                {SCROLL_TO 9 5}
                {UNIT 2 (Shmaltupp Sergeant) 9 5 (id,animate=guard_sergeant,yes)}

                # Want to store him here, so that he guts restored in same place next time
                [store_unit]
                    [filter]
                        id=guard_sergeant
                    [/filter]

                    variable=Shmaltupp.stored_sergeant
                [/store_unit]

                {CLOSE_EMPTY_HEX $unit.x $unit.y Wot 1}
                {MOVE_UNIT (id=guard_sergeant) $hex_x $hex_y}

                {MESSAGE guard_sergeant "" "" _"Hey, you! We cannot have strangers attacking our townsfolk! This might be a bit of a rough town, but we are still responsible for keeping things quiet here. As quiet as possible, that is."}
                {MESSAGE guard_sergeant "" "" _"I'll give you a break this time. I know old $second_unit.name here. Quite possibly he provoked you, but don't let me catch you a second time."}

                {MOVE_UNIT (id=guard_sergeant) 9 5}
                [kill]
                    id=guard_sergeant
                [/kill]
                {VARIABLE Shmaltupp.caught_fighting yes}

                [show_objectives]
                [/show_objectives]
                {NARRATOR_GRAY "Note" _"You can still try to pick money from the townspeople without Sergeant $Shmaltupp.stored_sergeant.name coming after you."}
            [/then]

            # If Grnk has been warned
            [else]
                {SOUND fanfare-short.wav}
                [unstore_unit]
                    variable=Shmaltupp.stored_sergeant
                    find_vacant=yes
                [/unstore_unit]
                {CLOSE_EMPTY_HEX $unit.x $unit.y Wot 1}
                {MOVE_UNIT (id=guard_sergeant) $hex_x $hex_y}
                {VARIABLE S2.hex_x_serg $hex_x}
                {VARIABLE S2.hex_y_serg $hex_y}

                {MESSAGE guard_sergeant "" "" _"You again! I warned you. You come with me now. I will lock you away for a long time. Guard!"}

                {SCROLL_TO 9 5}
                {UNIT 2 Spearman 9 5 (id,animate=second_guard,yes)}
                {CLOSE_EMPTY_HEX $unit.x $unit.y Wot 1}
                {MOVE_UNIT (id=second_guard) $hex_x $hex_y}

                {MESSAGE guard_sergeant "" "" _"Let's go."}

                # Also need to do this, or there might be a funny effect on the walk
                [modify_side]
                    side=2
                    team_name=Grnk
                    user_team_name="Human Army"
                [/modify_side]

                # Hide them first, so that they don't walk on top of each other
                [hide_unit]
                    x=$S2.hex_x_serg,$hex_x,$unit.x
                    y=$S2.hex_y_serg,$hex_y,$unit.y
                [/hide_unit]
                [move_units_fake]
                    [fake_unit]
                        type=$Shmaltupp.stored_sergeant.type
                        x=$S2.hex_x_serg,9
                        y=$S2.hex_y_serg,5
                        side=2
                    [/fake_unit]
                    [fake_unit]
                        type=$unit.type
                        x=$unit.x,$S2.hex_x_serg,9
                        y=$unit.y,$S2.hex_y_serg,5
                        side=1
                    [/fake_unit]
                    [fake_unit]
                        type=Spearman
                        x=$hex_x,$unit.x,$S2.hex_x_serg,9
                        y=$hex_y,$unit.y,$S2.hex_y_serg,5
                        side=2
                    [/fake_unit]
                [/move_units_fake]
                # And kill them at the very end
                [kill]
                    id=guard_sergeant,second_guard
                    fire_event=yes
                [/kill]

                # Don't want Grnk to give his farewell speech, so just hide him
                [hide_unit]
                    id=Grnk
                [/hide_unit]
                [endlevel]
                    result=defeat
                [/endlevel]

                {CLEAR_VARIABLE Shmaltupp.stored_sergeant}
            [/else]
        )}
        {CLEAR_VARIABLE hex_x,hex_y,S2.hex_x_serg,S2.hex_y_serg}
    [/event]

    ##### Rat events #####

    # Grnk kills a rat
    [event]
        name=die
        first_time_only=no

        [filter]
            type=Giant Rat
        [/filter]
        [filter_second]
            id=Grnk
        [/filter_second]

        {VARIABLE_OP Shmaltupp.rats_killed add 1}
        [switch]
            variable=Shmaltupp.rats_killed

            [case]
                value=1

                {MESSAGE Grnk "" ""  _"Look at me, I got one! I think I'll put this one into my bag."}
            [/case]

            [case]
                value=2

                {MESSAGE Grnk "" ""  _"Take that, foul vermin! Into the bag with you."}
            [/case]

            [case]
                value=3

                {MESSAGE Grnk "" ""  _"I could get used to this! Another one for the bag."}
            [/case]
        [/switch]

        {ADD_INVENTORY_ITEM "Rat, black, dead" rat}
    [/event]

    # When Grnk attacks a rat, after the third kill ...
    [event]
        name=attack
        first_time_only=no

        [filter]
            id=Grnk
        [/filter]
        [filter_attack]
            [not]
                name=pickpocket
            [/not]
        [/filter_attack]
        [filter_second]
            type=Giant Rat
        [/filter_second]

        # If Grnk has already killed 3 rats
        {IF_VAR Shmaltupp.rats_killed greater_than 2 (
            [then]
                {SOUND bat-hit-1.ogg}
                {MESSAGE $second_unit.id "" "" _"SQUEAK !!!"}
                {FAR_EMPTY_HEX $unit.x $unit.y Wot 2}
                {MOVE_UNIT id=$second_unit.id $hex_x $hex_y}
                {CLEAR_VARIABLE hex_x,hex_y}

                # The first time this happens, also have Grnk brag
                {IF_VAR Shmaltupp.rats_killed equals 3 (
                    [then]
                        {MESSAGE Grnk "" "" _"That's right, I'm Grnk, mighty killer of rats. Tremble before me!"}
                        {MESSAGE Grnk "" "" _"Nothing's ever been afraid of me before and now I have established a reputation among the rats of Shmaltupp. How pathetic is that?!"}
                        {VARIABLE Shmaltupp.rats_killed 99} # for convenience
                    [/then]
                )}
            [/then]
        )}
    [/event]

    ##### The bar - Deep Pint #####

    # Go to the bar
    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            x,y=21,15
        [/filter]

        {VARIABLE_OP Shmaltupp.bar_visited add 1}
        # Possibly to be replaced later
        {VARIABLE S2.bartender_portrait "portraits/dwarves/transparent/runemaster.png"}
        {BLACK_SCREEN_SHMALTUPP}

        [switch]
            variable=Shmaltupp.bar_visited

            [case]
                value=1

                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Welcome to the Deep Pint, laddie. What brings ya to town?"}
                {MESSAGE Grnk "" "" _"Just ... trying to start over."}
                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Ah, running away from somebody. Or something. Either way, the Deep Pint is the place to forget about ya worries. Would ya like a draught? Only 2 gold for a Shmaltupp Lager, or 3 for our very own Deep Pint Dark Reserve, brewed right here, in a mine directly underneath the basement."}
                {MESSAGE Grnk "" "" _"Umm, what's the difference?"}
                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Well, if ya just wanna get drunk cheaply, the Lager does the job, but let me tell ya, it tastes like rat piss. For a connoisseur like yaself, laddie, I'd definitely go with the Dark."}
            [/case]

            [case]
                value=2

                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Hey, ya're back! What can I do for ya, laddie?"}
            [/case]

            [case]
                value=3

                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Look who's here again! Ya're becoming a regular, laddie. How can I help ya?"}
            [/case]

            [else]
                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Welcome back, laddie. What would ya like this time?"}
            [/else]
        [/switch]

        # Choose drink
        [message]
            speaker=Grnk
            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Grnks_gold less_than 2}
                [/show_if]
                message=_"I don't have enough money for either beer, I guess I'll be leaving again."
                [command]
                    {VARIABLE S2.beer none}
                [/command]
            [/option]
            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Grnks_gold greater_than 1}
                    {VARIABLE_CONDITIONAL Grnks_gold less_than 3}
                [/show_if]
                message=_"I only have enough money for a Shmaltupp Lager. Give me one of those."
                [command]
                    {VARIABLE S2.beer Lager}
                [/command]
            [/option]
            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Grnks_gold greater_than 2}
                [/show_if]
                message=_"I'll have a Shmaltupp Lager"
                [command]
                    {VARIABLE S2.beer Lager}
                [/command]
            [/option]
            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Grnks_gold greater_than 2}
                [/show_if]
                message=_"I'll have a Deep Pint Dark Reserve"
                [command]
                    {VARIABLE S2.beer Dark}
                [/command]
            [/option]
            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Grnks_gold greater_than 1}
                [/show_if]
                message=_"I was just looking around. I'm on my way again."
                [command]
                    {VARIABLE S2.beer none}
                [/command]
            [/option]
        [/message]

        {IF_VAR S2.beer not_equals none (
            [then]
                {SOUND gold.ogg}
                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Here ya are, laddie. One $S2.beer."}
                {VARIABLE_OP Shmaltupp.beers_drunk add 1}
                {SOUND potion.ogg}

                {IF_VAR S2.beer equals Lager (
                    [then]
                        {CHANGE_BOTH_GOLDS 1 -2}
                        {IF_VAR Shmaltupp.had_lager equals yes (
                            [then]
                                {MESSAGE Grnk "" "" _"Bah! It's not any better even when you know what to expect."}
                            [/then]

                            [else]
                                {MESSAGE Grnk "" "" _"Whoa, you're right. This stuff is bad. But it's definitely potent."}
                                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"I told ya so."}
                                {VARIABLE Shmaltupp.had_lager yes}
                            [/else]
                        )}
                    [/then]

                    [else]
                        {CHANGE_BOTH_GOLDS 1 -3}
                        {IF_VAR Shmaltupp.had_dark equals yes (
                            [then]
                                {MESSAGE Grnk "" "" _"I still like this stuff."}
                            [/then]

                            [else]
                                {MESSAGE Grnk "" "" _"This is good beer."}
                                {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"I told ya so."}
                                {VARIABLE Shmaltupp.had_dark yes}
                            [/else]
                        )}
                    [/else]
                )}

                # Some added dialog after 1st and 2nd beer
                [switch]
                    variable=Shmaltupp.beers_drunk

                    [case]
                        value=1

                        {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"So tell me, laddie, why Shmaltupp? That seems like a strange choice for a goblin."}
                        {MESSAGE Grnk "" "" _"Well, I'm <i>really</i> sick and tired of the orcs and there aren't many other places that would even let me into town. I've been told that people here might not like me, but at least they won't throw rocks at me the moment they see me."}
                        {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Yah, that's probably right. There's hardly anybody in town who doesn't have something to hide, so for the most part, people will simply ignore ya as long as ya do the same."}
                        {MESSAGE Grnk "" "" _"That's good to know, thanks. I'll be on my way then."}

                    [/case]

                    [case]
                        value=3

                        {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"I don't want to put ya off, laddie, I hate to lose a good customer, but drowning yaself in alcohol might not be the best way to start a new life."}
                        {MESSAGE Grnk "" "" _"You're right. I better get on with it."}
                    [/case]

                    [else]
                        {MESSAGE Grnk "" "" _"Well, I better be leaving. Great deeds await."}
                    [/else]
                [/switch]

                {SOUND potion.ogg}
                [print]
                    text=_"Gulp, gulp."
                    size=18
                    duration=60
                    red,green,blue=255,255,255
                [/print]
                {DELAY 1300}

                # Store non-drunk Grnk for restoration when he's sober again
                [store_unit]
                    [filter]
                        id=Grnk
                    [/filter]

                    variable=S2.nondrunk_Grnk
                [/store_unit]

                # Add blue overlay, and set drunk variable
                [object]
                    silent=yes
                    [filter]
                        id=Grnk
                    [/filter]

                    [effect]
                        apply_to=image_mod
                        replace="B(128)"
                    [/effect]
                [/object]

                {MODIFY_UNIT (id=Grnk) variables.drunk yes}
            [/then]
        )}

        # Leaving the bar and cleaning up
        {MESSAGE narrator "$S2.bartender_portrait" _"Bartender" _"Thanks for stopping by, laddie. Come back any time, we're open around the clock."}
        {RESET_SCREEN_SHMALTUPP}
        {CLEAR_VARIABLE S2.bartender_portrait,S2.beer}
    [/event]

    # Grnk is drunk, random stumbling around
    [event]
        name=select
        first_time_only=no

        [filter]
            id=Grnk
            [filter_wml]
                [variables]
                    drunk=yes
                [/variables]
            [/filter_wml]
        [/filter]

        {MESSAGE Grnk "" "" _"Ugh, I don't feel so good ..."}

        {REPEAT 5 (
            {CLOSE_EMPTY_HEX $unit.x $unit.y Wot 2}
            {MOVE_UNIT_IMAGEMODS id=Grnk $hex_x $hex_y "B(128)"}
            {DELAY 200}
            {IF_VAR REPEAT_i equals 1 (
                [then]
                    {MESSAGE Grnk "" "" _"When did the ground start moving like that?"}
                [/then]
            )}
        )}

        # Restore the non-drunk Grnk
        {DELAY 500}
        [unstore_unit]
            variable=S2.nondrunk_Grnk
            x,y=$hex_x,$hex_y
        [/unstore_unit]
        {MESSAGE Grnk "" "" _"Ahh, that's better."}
        {CLEAR_VARIABLE hex_x,hex_y,S2.drunk_Grnk,S2.nondrunk_Grnk}
    [/event]

    ##### Camp entry #####

    # Grnk enters the camp
    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            [filter_location]
                x=10,12,14,16
                y=3,3,3,3
                [or]
                    x,y=8-15,4
                [/or]
                [or]
                    x,y=6-13,5
                [/or]
                [or]
                    x,y=5-11,6
                [/or]
                [or]
                    x,y=5-9,7
                [/or]
                [or]
                    x,y=5-7,8
                [/or]
                [or]
                    x,y=5,9
                [/or]
            [/filter_location]
        [/filter]

        # Koorzhar comes over, stays in camp
        {CLOSE_EMPTY_HEX $unit.x $unit.y (R*,G*) 1}
        {MOVE_UNIT (id=Koorzhar) $hex_x $hex_y}
        {CLEAR_VARIABLE hex_x,hex_y}

        # If this is the first time
        {IF_VAR Shmaltupp.camp_entered not_equals yes (
            [then]
                {MESSAGE Koorzhar "" "" _"Hey, kid, what do you think you are doing? You cannot just walk into the camp like that."}
                {MESSAGE Grnk "" "" _"I, uh, I didn't know that. Nobody told me."}
                {MESSAGE Koorzhar "" "" _"Hmm. I'm not quite sure why, but I actually believe you. You better leave the camp right away though, next time I will not be so lenient. And whoever didn't pay attention and let you pass will be on latrine duty for a month!"}
                {MESSAGE Grnk "" "" _"But I need to talk to you."}
                {MESSAGE Koorzhar "" "" _"You can do that from the other side of the fence, right across from where I am stationed."}
                {CLOSE_EMPTY_HEX 11 7 (C*,K*) 0}
                {MOVE_UNIT (id=Grnk) $hex_x $hex_y}
                {CLEAR_VARIABLE hex_x,hex_y}
                {MOVE_UNIT (id=Koorzhar) 8 7}

                {VARIABLE Shmaltupp.camp_entered yes}
                [show_objectives]
                [/show_objectives]
            [/then]

            [else]
                {MESSAGE Koorzhar "" "" {WHISPER _"I really need to have a word with those guards."}+_"
<i> </i>
You are trying my patience, kid. As much as I'd like to, I cannot let you get away with this."}

                [endlevel]
                    result=defeat
                [/endlevel]
            [/else]
        )}
    [/event]

    ##### Koorzhar #####

    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            [filter_location]
                x,y=8-9,8
            [/filter_location]
        [/filter]

        # If this is the first time
        {IF_VAR Shmaltupp.talked_to_Koorzhar not_equals yes (
            [then]
                {IF_VAR Shmaltupp.camp_entered equals yes (
                    [then]
                        {MESSAGE Koorzhar "" "" _"See, that wasn't so hard. So what are you doing here? You look a bit out of place."}
                    [/then]

                    [else]
                        {MESSAGE Koorzhar "" "" _"Hey, kid. What are you doing here? You look a bit out of place."}
                    [/else]
                )}

                {MESSAGE Grnk "" "" _"I am, but all the places where I fit in, I really don't want to be. I am sick and tired of living among other goblins and orcs. I know that I can become a better person. Can I join your unit?"}
                {MESSAGE Koorzhar "" "" _"Ah, well, you seem like a nice kid, but I don't really have a job for someone with no army training."}
                {MESSAGE Grnk "" "" _"But, what about all the peasants at the gates? You employ those. I can fight at least as well as they."}
                {MESSAGE Koorzhar "" "" _"That's different. They were born here. They stay here all the time. They work essentially for free and the orcs have been staying away from Shmaltupp lately, so there's not much risk of them actually having to do any fighting."}
                {MESSAGE Grnk "" "" _"How about <u>I</u> work for free? I could clean up your camp, if nothing else. All I need is a chance to get started."}
                {MESSAGE Koorzhar "" "" _"Sorry, kid, but I am not allowed to employ non-humans in town. HQ orders, you know. There really is nothing I can do."}
                {VARIABLE Shmaltupp.talked_to_Koorzhar yes}

                # Follow-up event, when Grnk starts moving away
                [event]
                    name=exit hex
                    [allow_undo]
                    [/allow_undo]

                    [filter]
                        id=Grnk
                    [/filter]

                    {MESSAGE Koorzhar "" "" _"Actually, kid, there might be one way. We are always short on scouts, horses do not do very well here. Your kind seems to have a knack for riding wolves. If you could find yourself a mount, I might have a job for you after all."}
                    {MESSAGE Grnk "" "" {WHISPER _"Maybe there is light at the end of the tunnel — and hopefully no badgers in the way!"}+"
<i> </i>
I have ridden a gryphon before, how about that?"}
                    {MESSAGE Koorzhar "" "" _"No, no gryphons. Sorry. We've had bad experiences with them before."}
                    {MESSAGE Grnk "" "" "I see. I'm off to catch myself a wolf then.
<i> </i>
"+{WHISPER _"But how the hell do I do that ??"}}
                    {MESSAGE Koorzhar "" "" _"Very good. And, kid, one more thing. There are a lot of shady characters in this town that you don't want to get involved with if you're serious about becoming a better person."}
                [/event]
            [/then]

            [else]
                {IF_VAR unit.name not_equals _"Grnk the Rider" (
                    [then]
                        {MESSAGE Koorzhar "" "" _"Hey there, kid. Have you gotten yourself a mount yet?"}
                        {MESSAGE Grnk "" "" _"No, not yet. Just checking if anything has changed. I'll be on my way again."}
                    [/then]

                    [else]
                        {IF_VAR Shmaltupp.Grnk_said_hes_rider not_equals yes (
                            [then]
                                {MESSAGE Koorzhar "" "" _"Hey there, kid. Have you gotten yourself a mount yet?"}
                                {MESSAGE Grnk "" "" _"Indeed, I have. My wolf is waiting outside the city gates."}
                                {MESSAGE Koorzhar "" "" _"Perfect. We are about to leave on our next mission and could use a scout. Meet us outside the city at dawn."}
                                {VARIABLE Shmaltupp.Grnk_said_hes_rider yes}
                            [/then]

                            [else]
                                {MESSAGE Koorzhar "" "" _"We are about to take off. If you want to come along, meet us outside the city gates."}
                            [/else]
                        )}

                        [message]
                            speaker=Grnk

                            [option]
                                message=_"I will be there."
                                [command]
                                    [if]
                                        {VARIABLE_CONDITIONAL unit.hitpoints equals $unit.max_hitpoints}
                                        {VARIABLE_CONDITIONAL unit.status.poisoned not_equals yes}
                                        [then]
                                            {MESSAGE Koorzhar "" "" _"Let's go then."}
                                            [switch]
                                                variable=Shmaltupp.times_to_Shmaltupp

                                                [case]
                                                    value=4

                                                    {VARIABLE S2.next_scen 07_Disillusion}
                                                [/case]

                                                [case]
                                                    value=5

                                                    {VARIABLE S2.next_scen 08_Trap}
                                                    {VARIABLE S8.ally_leader Koorzhar}
                                                [/case]
                                            [/switch]

                                            [endlevel]
                                                result=victory
                                                next_scenario=$S2.next_scen
                                                carryover_report=no
                                                bonus=no
                                                carryover_add=yes
                                                carryover_percentage=100
                                                linger_mode=no
                                            [/endlevel]

                                            {CLEAR_VARIABLE S2.next_scen}
                                        [/then]

                                        [else]
                                            {SPEECH_ABOUT_HEALING Koorzhar}
                                        [/else]
                                    [/if]
                                [/command]
                            [/option]

                            [option]
                                message=_"I need to take care of something else first."
                                [command]
                                    {MESSAGE Koorzhar "" "" _"Suit yourself, but don't take too long."}
                                [/command]
                            [/option]
                        [/message]
                    [/else]
                )}
            [/else]
        )}
    [/event]

    ##### Rutburt #####

    # In the scenarios when he is not there; only once per scenario
    [event]
        name=moveto

        [filter]
            id=Grnk
            x,y=27,11
            [not]
                [filter_adjacent]
                    id=Rutburt
                [/filter_adjacent]
            [/not]
        [/filter]

        {MESSAGE Grnk "" "" _"I wonder where Rutburt is. I hope nothing has happened to him."}
    [/event]

    # Talk to Rutburt
    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            [filter_adjacent]
                id=Rutburt
            [/filter_adjacent]
        [/filter]

        # If this is the first time
        {IF_VAR Shmaltupp.talked_to_Rutburt not_equals yes (
            [then]
                {MESSAGE Grnk "" "" _"Greetings. Are you Mister Rutburt?"}
                {MESSAGE Rutburt "" "" _"Who wants to know?"}
                {MESSAGE Grnk "" "" _"Umm, I do. My name is Grnk. I'm a goblin and ..."}
                {MESSAGE Rutburt "" "" _"No kidding! I never would have guessed. Except for the way you speak, that is. I've never met a goblin who can form complete sentences."}
                {MESSAGE Grnk "" "" _"... <i>and</i> Gertburt told me to talk to you. I am supposed to tell you that I fought the orcs with him."}
                {MESSAGE Rutburt "" "" _"He does? You did?? What's he been up to this time?"}
                {MESSAGE Grnk "" "" _"He ..."}
                {MESSAGE Rutburt "" "" _"Never mind, I don't want to know."}
                {MESSAGE Grnk "" "" _"Actually, he ..."}
                {MESSAGE Rutburt "" "" _"No, I <i>really</i> don't want to know. But let's go inside, it's more ... private in there. You never know who's listening in this town. I'd rather not have old Koorzhar know everything we discuss within the hour."}
            [/then]

            [else]
                {MESSAGE Rutburt "" "" _"Hello again, little fella. After you ..."}
            [/else]
        )}

        # Go inside
        [if]
            {VARIABLE_CONDITIONAL x1 equals 27}
            {VARIABLE_CONDITIONAL y1 equals 11}

            [then]
                # Nothing needs to be done if he already is on the pub hex
            [/then]

            [else]
                # If the pub hex is occupied
                [if]
                    [have_unit]
                        x,y=27,11
                    [/have_unit]

                    [then]
                        {MESSAGE Rutburt "" "" _"Excuse me."}
                        {MOVE_UNIT x,y=27,11 26 11}
                        # This will work even if 26 11 is occupied
                    [/then]
                [/if]
                {MOVE_UNIT id=Grnk 27 11}
            [/else]
        [/if]

        [hide_unit]
            id=Grnk
        [/hide_unit]
        {STORE_UNIT_VAR (id=Rutburt) type S2.Rutburt_type}
        [hide_unit]
            id=Rutburt
        [/hide_unit]
        [move_unit_fake]
            type=$S2.Rutburt_type
            side=3
            x=26,27
            y=10,11
        [/move_unit_fake]
        {DELAY 500}
        {BLACK_SCREEN_SHMALTUPP}

        # If this is the first time
        {IF_VAR Shmaltupp.talked_to_Rutburt not_equals yes (
            [then]
                {VARIABLE Shmaltupp.talked_to_Rutburt yes}
                {MESSAGE Rutburt "" "" _"That's better. So tell me, little fella, what's a goblin doing in a human town?"}
                {IF_VAR Shmaltupp.talked_to_Koorzhar not_equals yes (
                    [then]
                        {MESSAGE Grnk "" "" _"I came here to get a new start, but now I don't really know what to do."}
                        {MESSAGE Rutburt "" "" _"Well, you could of course try the army camp over there, but, let me tell you, they are quite picky and probably won't take you. On the other hand, we have a little group going here, me and a few chaps. We go on occasional ... expeditions. They are not without risk, but if they go well, you can make a lot more money than with the military."}
                    [/then]

                    [else]
                        {MESSAGE Grnk "" "" _"I came here to try my luck with the army, but they tell me that I am not experienced enough to join them."}
                        {MESSAGE Rutburt "" "" _"Well, that's old Koorzhar for you, he can be quite a prick. On the other hand, we have a little group going here, me and a few chaps. We go on occasional ... expeditions. They are not without risk, but if they go well, you can make a lot more money than with the military."}
                    [/else]
                )}
                {MESSAGE Grnk "" "" _"What kind of ... expeditions?"}
                {MESSAGE Rutburt "" "" _"Ah, I cannot tell you that. How do I know you're not a spy for Koorzhar? You'll just have to come along. I'll keep an eye on you and if you do well, I promise you won't regret it."}
            [/then]
        )}

        {IF_VAR Shmaltupp.times_to_Shmaltupp equals 1 (
            [then]
                {MESSAGE Rutburt "" "" _"So ... Do you want to join us? We'll be leaving shortly on our next outing."}
            [/then]

            [else]
                {MESSAGE Rutburt "" "" _"We're about to take off again. Do you want to come along?"}
            [/else]
        )}

        [message]
            speaker=Grnk
            [option]
                message=_"I'll come with you."
                [command]
                    # Cannot just use $unit.hitpoints, as this seems to be changed by the MOVE_UNIT above
                    {STORE_UNIT_VAR id=Grnk hitpoints S2.Grnk_hp}
                    {STORE_UNIT_VAR id=Grnk max_hitpoints S2.Grnk_maxhp}
                    {STORE_UNIT_VAR id=Grnk status.poisoned S2.Grnk_poisoned}
                    [if]
                        {VARIABLE_CONDITIONAL S2.Grnk_hp equals $S2.Grnk_maxhp}
                        {VARIABLE_CONDITIONAL S2.Grnk_poisoned not_equals yes}
                        [then]
                            {MESSAGE Rutburt "" "" _"Great! Let's go then."}
                            [switch]
                                variable=Shmaltupp.times_to_Shmaltupp

                                [case]
                                    value=1

                                    {VARIABLE S2.next_scen 03_Treasure}
                                [/case]

                                [case]
                                    value=2

                                    {VARIABLE S2.next_scen 04_Mercenaries}
                                [/case]

                                [case]
                                    value=5

                                    {VARIABLE S2.next_scen 08_Trap}
                                    {VARIABLE S8.ally_leader Rutburt}
                                [/case]
                            [/switch]

                            [endlevel]
                                result=victory
                                next_scenario=$S2.next_scen
                                carryover_report=no
                                bonus=no
                                carryover_add=yes
                                carryover_percentage=100
                                linger_mode=no
                            [/endlevel]

                            {CLEAR_VARIABLE S2.next_scen}
                        [/then]

                        [else]
                            {SPEECH_ABOUT_HEALING Rutburt}
                        [/else]
                    [/if]
                    {CLEAR_VARIABLE S2.Grnk_hp,S2.Grnk_maxhp,S2.Grnk_poisoned}
                [/command]
            [/option]

            [option]
                message=_"I need time to think about this."
                [command]
                    {MESSAGE Rutburt "" "" _"You know where to find me. We leave on these excursions quite frequently."}
                [/command]
            [/option]
        [/message]

        # Come back outside
        {RESET_SCREEN_SHMALTUPP}
        {DELAY 500}
        [move_unit_fake]
            type=$S2.Rutburt_type
            side=3
            x=27,26
            y=11,10
        [/move_unit_fake]
        [unhide_unit]
            id=Rutburt
        [/unhide_unit]
        [unhide_unit]
            id=Grnk
        [/unhide_unit]
        {CLEAR_VARIABLE S2.Rutburt_type}
    [/event]

    ##### STC Hospital #####
    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            x,y=18,9
        [/filter]

        # Possibly to be replaced later
        {RANDOM "1,2"}
        {IF_VAR random equals 1 (
            [then]
                {VARIABLE S2.hospital_portrait "portraits/humans/transparent/mage-white+female.png"}
            [/then]

            [else]
                {VARIABLE S2.hospital_portrait "portraits/humans/transparent/mage-white.png"}
            [/else]
        )}
        {CLEAR_VARIABLE random}

        {BLACK_SCREEN_SHMALTUPP}
        {MESSAGE narrator "$S2.hospital_portrait" "" _"Welcome to Shmaltupp City Hospital. We take care of all your medical needs. We heal for $Money.STC_gold_per_hitpoint gold per hitpoint and cure you of poison for $Money.STC_curing_cost gold. What can we do for you?"}

        [message]
            speaker=Grnk

            [option]
                {HEALING_OPTION "" "$S2.hospital_portrait" $Money.STC_gold_per_hitpoint 0}
                [/command]
            [/option]

            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL unit.status.poisoned equals yes}
                [/show_if]
                message=_"I would like to be cured of poison."
                [command]
                    {MESSAGE narrator "$S2.hospital_portrait" "" _"Certainly. That will be $Money.STC_curing_cost gold."}
                    {IF_VAR Grnks_gold greater_than_equal_to $Money.STC_curing_cost (
                        [then]
                            {SOUND gold.ogg}
                            {MESSAGE Grnk "" "" _"Here you are."}
                            {SOUND heal.wav}
                            {CHANGE_BOTH_GOLDS 1 -$Money.STC_curing_cost}
                            {MODIFY_UNIT id=Grnk (status.poisoned) no}
                        [/then]

                        [else]
                            {MESSAGE Grnk "" "" _"I do not have that much gold. I will have to come back later."}
                        [/else]
                    )}
                [/command]
            [/option]

            [option]
                message=_"I was just checking out what you do here. I'm off again."
                [command]
                [/command]
            [/option]
        [/message]
        {MESSAGE narrator "$S2.hospital_portrait" "" _"Thank you for visiting Shmaltupp City Hospital. Do not hesitate to come back whenever you are in need of medical attention."}

        {RESET_SCREEN_SHMALTUPP}
        {CLEAR_VARIABLE S2.hospital_portrait}
    [/event]

    ##### Quank's #####
    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            x,y=19,19
        [/filter]

        # Possibly to be replaced later
        {VARIABLE S2.quank_portrait "portraits/dwarves/transparent/ulfserker.png"}
        {BLACK_SCREEN_SHMALTUPP}

        {IF_VAR Shmaltupp.talked_to_Quank not_equals yes (
            [then]
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Welcome to Quank's."}
                {MESSAGE Grnk "" "" _"Umm, why are you carrying an axe? Isn't this a hospital?"}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Have you had a look around out there? This isn't exactly the best neighborhood of not exactly the best town around here. You never know who walks through the door. But don't be alarmed, we are very friendly here. We do everything for the customer — as long as you don't try to steal the furniture."}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Quank's is not a hospital, nothing as mundane as that, but a personal medical retreat and spa. The best within 100 leagues, you can believe that! As well as a pharmacy, taxidermy, gift shop and hair salon. Do you like my hair? It's <i>the</i> style this season."}
                {MESSAGE Grnk "" "" _"Uh, yes, very nice.

"+{WHISPER _"I learned long ago never to disagree with a guy who's packed with muscles and carrying a battle axe, even if he is only 4 feet tall. Especially if you're barely any taller yourself, without the muscles."}}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"We are also a registered travel agency. Of course, when we started, there was nowhere to register with, so I founded the QTAA, Quank's Travel Agent Association. We have 7 members now, in 5 towns, all of them owned by me, Quank. How about a nice cruise down the Big Shmaltupp River to the coast, along the Eldryanic River Delta and all the way to the Bay of Scales? Or an ox cart ride through the countryside? We have the fastest oxen and the most comfortable carts west of the High Plains."}
                {MESSAGE Grnk "" "" _"No, thank you. I was just coming to check out the cost of your medical services."}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"It's 1 gold for every 4 hitpoints healed."}
                {MESSAGE Grnk "" "" _"How about poison?"}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"What about poison??? Who said anything about poison?!? I don't do poison. I don't make poison, sell poison, and I definitely do not poison my customers. What happened to my last patient had nothing to do with me!"}
                {MESSAGE Grnk "" "" _"I just meant: how much do you charge for curing of poison?"}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Oh."}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"No, don't do that either."}
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"So what can Quank's do for you?"}
                {VARIABLE Shmaltupp.talked_to_Quank yes}
            [/then]

            [else]
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Welcome back. What can Quank's do for you? How about that cruise? Or a nice stylish haircut?"}

                [if]
                    {VARIABLE_CONDITIONAL Shmaltupp.times_to_Shmaltupp equals 4}
                    {VARIABLE_CONDITIONAL Shmaltupp.talked_about_driver not_equals yes}
                    [then]
                        {VARIABLE Shmaltupp.talked_about_driver yes}
                        {MESSAGE Grnk "" "" _"About that driver of yours ..."}
                        {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Yes, yes, he has been sufficiently disciplined. And we have a strict no refund policy. Now what can I do for you?"}
                    [/then]

                    [else]
                    [/else]
                [/if]
            [/else]
        )}

        # Number of rats in inventory:
        {LOOKUP_INDEX inventory short rat S2.rat_index}
        # Keep one rat before the wolf is caught (after which Grnk's name will be changed)
        {IF_VAR S2.rat_index not_equals $inventory.length (
            [then]
                {IF_VAR unit.name not_equals _"Grnk the Frail" (
                    [then]
                        {VARIABLE S2.rats_to_sell "$inventory[$S2.rat_index].number"}
                    [/then]

                    [else]
                        {VARIABLE S2.rats_to_sell "$($inventory[$S2.rat_index].number-1)"}
                    [/else]
                )}
            [/then]

            [else]
                {VARIABLE S2.rats_to_sell 0}
            [/else]
        )}

        [message]
            speaker=Grnk

            [option]
                {HEALING_OPTION "Quank" "$S2.quank_portrait" $Money.Quank_gold_per_hitpoint 25}
                [/command]
            [/option]

            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Shmaltupp.cage_bought equals yes}
                    {VARIABLE_CONDITIONAL Shmaltupp.cart_rented not_equals yes}
                [/show_if]
                message=_"I would like to rent an ox cart."
                [command]
                    {IF_VAR Shmaltupp.talked_about_cart not_equals yes (
                        [then]
                            {MESSAGE narrator "$S2.quank_portrait" "Quank" _"You have come to the right place, we have the fastest oxen and the ..."}
                            {MESSAGE Grnk "" "" _"Yes, yes, you said that already. I need to transport a big wolf cage. How much do you charge for that?"}
                            {MESSAGE narrator "$S2.quank_portrait" "Quank" _"It's $Money.cart_cost for our super-deluxe carts plus driver."}
                            {MESSAGE Grnk "" "" _"What?!? That's crazy!"}
                            {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Feel free to see if you can get a cheaper one anywhere around here. Or at all, as a matter of fact. At this price, this barely even covers expenses."}
                            {MESSAGE Grnk "" "" _"How much is it if I don't take the super-deluxe version?"}
                            {MESSAGE narrator "$S2.quank_portrait" "Quank" _"We only have the super-deluxe model. We could not possibly expose our customers to anything else."}
                            {MESSAGE Grnk "" "" _"Then what about me driving it myself?"}
                            {MESSAGE narrator "$S2.quank_portrait" "Quank" _"That's not an option. It's $Money.cart_cost gold or no cart."}
                            {VARIABLE Shmaltupp.talked_about_cart yes}
                        [/then]

                        [else]
                            {MESSAGE narrator "$S2.quank_portrait" "Quank" _"It's still $Money.cart_cost gold."}
                        [/else]
                    )}

                    {IF_VAR Grnks_gold greater_than_equal_to $Money.cart_cost (
                        [then]
                            [message]
                                speaker=Grnk

                                [option]
                                    message=_"I'll take the cart"
                                    [command]
                                        # Make sure this can only happen the third time to Shmaltupp
                                        # This should not be necessary, as Grnk shouldn't have enough money
                                        # The first two times, but just in case
                                        #
                                        # Also cannot leave if Grnk doesn't have a rat
                                        #{DEBUG "rats: $S2.rat_index $inventory.length"}

                                        [if]
                                            {VARIABLE_CONDITIONAL Shmaltupp.times_to_Shmaltupp equals 3}
                                            {VARIABLE_CONDITIONAL S2.rat_index not_equals $inventory.length}
                                            [then]
                                                {CHANGE_BOTH_GOLDS 1 -$Money.cart_cost}
                                                # Quank asks whether Grnk wants to be healed
                                                [if]
                                                    {VARIABLE_CONDITIONAL unit.hitpoints equals $unit.max_hitpoints}
                                                    {VARIABLE_CONDITIONAL unit.status.poisoned not_equals yes}
                                                    [then]
                                                        {LEAVE_ON_WOLF_HUNT}
                                                    [/then]

                                                    [else]
                                                        {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Perfect. But are you sure you want to leave all beaten up like that?"}
                                                        [message]
                                                            speaker=Grnk
                                                            message=_"Now that I think about it:"
                                                            [option]
                                                                # No chance of getting poisoned in this case
                                                                {HEALING_OPTION "Quank" "$S2.quank_portrait" $Money.Quank_gold_per_hitpoint 0}
                                                                    {LEAVE_ON_WOLF_HUNT}
                                                                [/command]
                                                            [/option]
                                                            [option]
                                                                message=_"I will leave the way I am."
                                                                [command]
                                                                    {LEAVE_ON_WOLF_HUNT}
                                                                [/command]
                                                            [/option]
                                                            [option]
                                                                message=_"I will be back later."
                                                                [command]
                                                                    # Need to restore his money (needed to be changed earlier to assess healing cost)
                                                                    {CHANGE_BOTH_GOLDS 1 $Money.cart_cost}
                                                                [/command]
                                                            [/option]
                                                        [/message]
                                                    [/else]
                                                [/if]
                                            [/then]
                                            [else]
                                                {IF_VAR Shmaltupp.times_to_Shmaltupp not_equals 3 (
                                                    [then]
                                                        {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Very good. But I do not have a cart available right now."}
                                                    [/then]

                                                    [else]
                                                        {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Very good. But before you leave, do you have bait for the cage? I can sell you the most exquisite dead giant rats. Only 11 gold a piece."}
                                                        {MESSAGE Grnk "" "" _"I forgot about that! Thanks, but no thanks. I'll catch one myself."}
                                                    [/else]
                                                )}
                                            [/else]
                                        [/if]
                                    [/command]
                                [/option]

                                [option]
                                    message=_"I think I'll wait."
                                [/option]
                            [/message]
                        [/then]

                        [else]
                            {MESSAGE Grnk "" "" _"I don't have that much money."}
                            {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Maybe some other time then."}
                        [/else]
                    )}
                [/command]
            [/option]

            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Shmaltupp.cage_bought equals yes}
                    {VARIABLE_CONDITIONAL S2.rats_to_sell greater_than 0}
                [/show_if]
                message=_"I have some dead giant rats for sale."
                [command]
                    {MESSAGE narrator "$S2.quank_portrait" "Quank" _"I can always use dead giant rats. How many do you have for sale?"}
                    {IF_VAR unit.name not_equals _"Grnk the Frail" (
                        [then]
                            {MESSAGE Grnk "" "" _"Uh, $S2.rats_to_sell."}
                        [/then]

                        [else]
                            {MESSAGE Grnk "" "" _"Uh, $S2.rats_to_sell. I better keep one for myself."}
                        [/else]
                    )}
                    {VARIABLE S2.money_for_rats "$($S2.rats_to_sell*$Money.rat_pay)"}
                    {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Ah, I see. Well, better than nothing, I guess. I'll give you $S2.money_for_rats gold."}
                    {MESSAGE Grnk "" "" _"Better than nothing, I guess."}
                    {SOUND gold.ogg}
                    {CHANGE_BOTH_GOLDS 1 $S2.money_for_rats}
                    {REPEAT $S2.rats_to_sell ({REMOVE_INVENTORY_ITEM rat})}
                [/command]
            [/option]

            [option]
                message=_"I think I am good for now."
                [command]
                [/command]
            [/option]
        [/message]

        [if]
            {VARIABLE_CONDITIONAL S2.poisoned_by_Quank not_equals yes}
            {VARIABLE_CONDITIONAL S2.cart_rented_right_now not_equals yes}
            [then]
                {MESSAGE narrator "$S2.quank_portrait" "Quank" _"Come back soon. Quank's can help you with (almost) all of your needs."}
            [/then]
        [/if]

        {RESET_SCREEN_SHMALTUPP}

        {IF_VAR S2.poisoned_by_Quank equals yes (
            [then]
                {MESSAGE Grnk "" "" _"Argh! That quack poisoned me! I should have gone to the hospital after all. I don't dare complaining though, I am no match for that guy. And I might still need him."}
            [/then]
        )}

        {CLEAR_VARIABLE S2.quank_portrait,S2.poisoned_by_Quank,S2.rat_index,S2.rats_to_sell,S2.money_for_rats,S2.cart_rented_right_now}
    [/event]

    ##### Older's General Store #####
    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            x,y=21,12
        [/filter]

        # Possibly to be replaced later
        {VARIABLE S2.grocer_portrait "portraits/humans/transparent/woodsman.png~CROP(8,30,290,280)"}
        {BLACK_SCREEN_SHMALTUPP}

        {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Welcome to Older's General Store, the one-stop location for all your needs. How can I help you?"}

        [message]
            speaker=Grnk

            [option]
                [show_if]
                    {VARIABLE_CONDITIONAL Shmaltupp.talked_to_Koorzhar equals yes}
                    {VARIABLE_CONDITIONAL Shmaltupp.cage_bought not_equals yes}
                [/show_if]
                message=_"I need a wolf trap."
                [command]
                    {IF_VAR Shmaltupp.talked_about_cage not_equals yes (
                         [then]
                             {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Why, certainly. We have the finest slings this side of the Eldryanic River and they happen to be on sale this week. Only 15 gold. No animal has ever escaped from these, they're strong enough to take a bear's head off. You probably won't even have to kill the wolf any more when you get there."}
                             {MESSAGE Grnk "" "" _"No, no, I need to catch a wolf alive and unhurt and tame it."}
                             {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"You what?? Are you insane? Do you know how big those wild wolves are? I wouldn't get near one if I were twice as large as you are — unless they are in one of my traps, of course."}
                             {MESSAGE Grnk "" "" _"I have, in fact, seen wild wolves before and know how large they are. I nevertheless need to trap one."}
                             {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Whatever strikes your fancy ... I have the finest cage traps as well. Here is what you want. Auto-locking, made from the best iron from the northern mines and hand-fitted to maximize strength. No animal has ever broken out of one of these. It is yours for only $Money.cage_cost gold."}
                             {VARIABLE Shmaltupp.talked_about_cage yes}
                         [/then]

                         [else]
                             {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Still trying to commit suicide, eh? Well, it's your lucky day, the cages still only cost $Money.cage_cost gold."}
                        [/else]
                    )}

                    {IF_VAR Grnks_gold greater_than_equal_to $Money.cage_cost (
                        [then]
                            [message]
                                speaker=Grnk

                                [option]
                                    message=_"That's a lot of money, but I have no choice. I take it."
                                    [command]
                                        {SOUND gold.ogg}
                                        {CHANGE_BOTH_GOLDS 1 -$Money.cage_cost}
                                        {VARIABLE Shmaltupp.cage_bought yes}
                                        {ADD_INVENTORY_ITEM "Receipt: 1 cage, metal, $Money.cage_cost gold paid" cage}

                                        {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"It's a pleasure doing business with a gentleman like you. If I may ask, what are you going to do about bait?"}
                                        {MESSAGE Grnk "" "" {WHISPER _"Nobody's ever called me a gentleman before!"}+_"

Uh, I hadn't thought of that."}
                                        {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"I could sell you some horse meat that's only a couple weeks old, but just between you and me, what works best for bait are dead rats. You could go to Quank's and he'd sell you some, but why don't you just catch yourself a couple? Doesn't cost you anything, there's quite an infestation going on in the eastern part of town, and you might even be able to sell Quank those that you don't need yourself."}
                                        {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"And how about transporting the cage? It's a bit heavy for you to carry."}
                                        {MESSAGE Grnk "" "" _"Right. Sigh! Another good question."}
                                        {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"I guess you won't get around Quank for that one. Unless you can find yourself a friendly troll somewhere. Haven't seen one around town in years though."}
                                        {MESSAGE Grnk "" "" _"That's all very good to know. Thank you very much. People aren't usually this nice to a goblin."}
                                        {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Anything for a good customer."}
                                    [/command]
                                [/option]

                                [option]
                                    message=_"I think I'll wait."
                                    [command]
                                        {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Good-bye."}
                                    [/command]
                                [/option]
                            [/message]
                        [/then]

                        [else]
                            {MESSAGE Grnk "" "" _"I don't have that kind of money."}
                            {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Come back when you do. But hurry, this price is only good while supplies last."}
                        [/else]
                    )}
                [/command]
            [/option]

            [option]
                message=_"I don't know what I want right now. I will be back later."
                [command]
                    {MESSAGE narrator "$S2.grocer_portrait" "Grocer" _"Good-bye."}
                [/command]
            [/option]
        [/message]

        {RESET_SCREEN_SHMALTUPP}
        {CLEAR_VARIABLE S2.grocer_portrait}
    [/event]

    ##### Assassin #####
    # Appears only at night, and first time only if Grnk is in the east of town
    [event]
        name=side 1 turn
        first_time_only=no

        [store_time_of_day]
            variable=S2.time_of_day
        [/store_time_of_day]
        {STORE_UNIT_VAR (id=Grnk) x S2.Grnk_x}
        {STORE_UNIT_VAR (id=Grnk) y S2.Grnk_y}
        #{DEBUG "$S2.time_of_day.id, $S2.Grnk_x $S2.Grnk_y"}

        [if]
            # This will _not_ catch for both "yes" and "gone"
            {VARIABLE_CONDITIONAL Shmaltupp.assassin_appeared equals ""}
            [and]
                {VARIABLE_CONDITIONAL S2.Grnk_x greater_than 18}
                [or]
                    {VARIABLE_CONDITIONAL S2.Grnk_y greater_than 14}
                [/or]
            [/and]
            [and]
                {VARIABLE_CONDITIONAL S2.time_of_day.id equals first_watch}
                [or]
                    {VARIABLE_CONDITIONAL S2.time_of_day.id equals second_watch}
                [/or]
            [/and]
            [then]
                #{DEBUG "Assassin appears"}
                {VARIABLE Shmaltupp.assassin_appeared yes}

                {CLOSE_EMPTY_HEX $S2.Grnk_x $S2.Grnk_y W*,S* 1}
                {SCROLL_TO $S2.Grnk_x $S2.Grnk_y}
                {UNIT 5 (Assassin) $hex_x $hex_y (id=Assassin)}
                {MESSAGE Grnk "" "" _"Who are you? Where did you come from? I didn't see or hear you coming at all."}
                {MESSAGE Assassin "" "" _"Indeed, that was the point. But never mind that, you look like somebody who appreciates certain ... substances."}
                {MESSAGE Grnk "" "" _"What are you insinuating? I don't do drugs!"}
                {MESSAGE Assassin "" "" _"No, no, no, no! That's not at all what I mean. But I do have certain ... potions for sale, in case you are interested."}
                {MESSAGE Grnk "" "" _"I'm listening."}
                {MESSAGE Assassin "" "" _"Well, for starters, here is a healing potion. It restores you to perfect health immediately. I am selling this one for $Money.healing_potion_cost gold."}
                {MESSAGE Assassin "" "" _"More interestingly though, as far as I am concerned, this vial contains a very rare and powerful poison. It does much more damage than normal poison. It is also incurable and will quickly kill the affected person. It is yours for only $Money.poison_cost gold. I am practically giving it away at that price."}
                {ASSASSIN_OPTIONS}
            [/then]
        [/if]
        {CLEAR_VARIABLE S2.time_of_day,S2.Grnk_x,S2.Grnk_y,hex_x,hex_y}
    [/event]

    # The next time, the assassin appears at 22,22, but only at night
    # After both potions have been bought, this is disabled by resetting 'Shmaltupp.assassin_appeared' to 'gone'
    [event]
        name=moveto
        first_time_only=no

        [filter]
            id=Grnk
            x,y=22,22
        [/filter]
        [filter_condition]
            {VARIABLE_CONDITIONAL Shmaltupp.assassin_appeared equals yes}
        [/filter_condition]

        # Only at night
        [store_time_of_day]
            variable=S2.time_of_day
        [/store_time_of_day]

        [if]
            {VARIABLE_CONDITIONAL S2.time_of_day.id equals first_watch}
            [or]
                {VARIABLE_CONDITIONAL S2.time_of_day.id equals second_watch}
            [/or]

            [then]
                [unstore_unit]
                    variable=Shmaltupp.stored_assassin
                    find_vacant=yes
                    x,y=22,22
                [/unstore_unit]

                {MESSAGE Assassin "" "" _"I had a feeling that you would be back."}
                {VARIABLE Shmaltupp.met_at_22_22 yes}
                {ASSASSIN_OPTIONS}
            [/then]
        [/if]

        {CLEAR_VARIABLE S2.time_of_day}
    [/event]

    ##### Park Message #####
    [event]
        name=moveto
        first_time_only=no
        [filter]
            id=Grnk
            x,y=14,11
        [/filter]

        # If this is the first time
        {IF_VAR Shmaltupp.park_seen not_equals yes (
            [then]
                {MESSAGE Grnk "" "" _"This is a rather nice park for a seamy little town like this."}
                {VARIABLE Shmaltupp.park_seen yes}
            [/then]
        )}
    [/event]

    ##### Cleaning up on every exit from Shmaltupp ... ####
    [event]
        name=victory

        # Restore Grnk's normal movement points
        {MODIFY_UNIT id=Grnk max_moves $S2.Grnk_max_moves}
        {CLEAR_VARIABLE S2.Grnk_max_moves}

        # Put him back onto his wolf
        [if]
            [have_unit]
                id=Grnks_wolf
            [/have_unit]

            [then]
                # Store Grnk
                [store_unit]
                    [filter]
                        id=Grnk
                    [/filter]

                    variable=stored_Grnk
                    kill=yes
                [/store_unit]

                # Store the wolf
                [store_unit]
                    [filter]
                        id=Grnks_wolf
                    [/filter]

                    variable=stored_Grnks_wolf
                    kill=yes
                [/store_unit]

                # Unstore Grnk the Rider
                [unstore_unit]
                    variable=S2.stored_Grnk_rider
                    x,y=$stored_Grnks_wolf.x,$stored_Grnks_wolf.y
                [/unstore_unit]

                # Clear pickpocketing menu
                {CLEAR_MENU_PICKPOCKET}

                {CLEAR_VARIABLE S2.stored_Grnk_rider}
            [/then]
        [/if]

        # Delete the scenario information menu item
        [set_menu_item]
            id=m002_menu_scenario2
            [show_if]
                [not]
                [/not]
            [/show_if]
        [/set_menu_item]

        # Clean up variables
        {CLEAR_VARIABLE S2}
    [/event]

    # The standard events for all or most scenarios
    {STORY_IMAGE id=Grnk}
    {PICKPOCKET_EVENTS (type=Grnk the Spearman,Grnk the Rouser)}
    {POISON_ATTACK_EVENTS}
    {HEALING_POTION_MESSAGE}
    {GRNK_DEATH}
